---
title: "Thriving in a changing world: A 130 years shell record of an intertidal predator from the Southern North Sea"
titlerunning: "Thriving in a changing world"
thanks: | 
    This study was supported by a NERC studentship awarded to DM (NE/L002507/1).

authors: 
- name: Dennis Mayk
  address:  Department of Earth Sciences, University of Cambridge, Cambridge, United Kingdom &
            British Antarctic Survey, Cambridge, United Kingdom
  email: dm807@cam.ac.uk
  
- name: Lloyd S. Peck
  address: British Antarctic Survey, Cambridge, United Kingdom
  
- name: Thierry Backeljau
  address: Royal Belgian Institute of Natural Sciences, Brussels, Belgium &
           Evolutionary Ecology Group, University of Antwerp, Antwerp, Belgium
  
- name: Elizabeth M. Harper
  address: Department of Earth Sciences, University of Cambridge, Cambridge, United Kingdom &
           British Antarctic Survey, Cambridge, United Kingdom

keywords:
- shell thickness
- mineralogy
- shell shape
- ocean acidification
- invasive species
- eutrophication
- ocean warming

abstract: |
  Ocean acidification and global climate change are predicted to negatively impact marine calcifiers, with species inhabiting the intertidal zone being especially vulnerable. Current predictions of organism responses to projected changes are largely based on relatively short to medium term experiments over periods of a few days to a few years. Here we look at responses over a longer time span and present a 130 years shell shape and shell thickness record of the marine intertidal predator gastropod *Nucella lapillus* (dog whelk). We show that contrary to global predictions, *N. lapillus* built continuously thicker shells and exhibits significant changes in shell shape on the Southern North Sea coast throughout the last century. We argue that the observed shell thickening of *N. lapillus* is the result of higher annual temperatures, longer yearly calcification windows, near shore eutrophication and enhanced prey abundance, mitigating the impact of global climate change.

bibliography: references.bib
biblio-style: spphys
# bibstyle options spbasic(default), spphys, spmpsci
output: rticles::springer_article
fontsize: 12
header-includes:
  - \usepackage{lineno}
  - \linenumbers
  - \usepackage{setspace}
---

```{r include=FALSE} 
library("tidyverse")
library("mgcv")
library("Momocs")
```

<!-- For initial submission set main text line space to double -->
\doublespacing 

# Introduction {#intro}

With the increase of carbon dioxide in the atmosphere accompanied by a rise in (seawater) temperature, ocean acidification (OA; decreasing seawater pH) and more frequent extreme weather events, many marine species and ecosystems are at risk. In recent years, much effort has been made to study the impact of rising seawater temperatures, OA and the synergistic mixed effects of both on the development and survival of species at risk [@Byrne2011-ql; @Byrne2013-om; @Fitzer2015-nr; @Hofmann2010-uq; @Kroeker2013-nr; @Kroeker2016-ma; @Parker2013-zx]. Special attention was thereby given to study the impacts on larval development [@Przeslawski2015-ph; @Suckling2015-hv; @Thomsen2015-wi; @Waldbusser2014-qn; @Waldbusser2015-ll] and biomineralization in both juveniles and adults, especially in calcium carbonate shell-bearing species[@Barclay2019-xu; @Cross2015-np; @Cross2015-rr] as those are believed to be most impacted by global climate change [@Byrne2013-om; @Doney2009-wq; @Watson2012-fy]. Despite these efforts, our understanding of, and ability to predict future changes in global or regional ecosystems, assemblages, populations, or even single species is still limited. 

Many relatively short-term experiments ranging from days to a few years report predominantly negative impacts on shell strength, size and thickness of shell forming marine species [@Barclay2019-xu; @Fitzer2014-mg; @Gaylord2011-aj; @Gazeau2013-cs]. Yet, sometimes no such effects are observed or even reversed effects (e.g., shell thickening) are reported [@Bullard2021-lk; @Cross2015-np; @Cross2019-kd]. Long-term experiments accounting for phenotypic plasticity (within and across generations) and genetic adaptations are receiving increasingly more attention [@Ashton2017-cm; @Cornwall2020-ub; @Donelson2018-py; @Gibbin2017-kh] as these processes are critical to allow for the full phenotypic responses to the altered environment of the future ocean [@Peck2011-ua; @Somero2012-pq; @Telesca2021-zm]. Conventional laboratory experiments often lack the variability and complexity of natural ecosystems by keeping relevant parameters stable to reduce the experimental “noise” [@Kroeker2020-uq]. This has the potential benefit of unmasking miniscule organism responses that would otherwise remain unnoticed due to fluctuating environmental factors. However, these responses may not be representative of organisms inhabiting the natural environment, as spatial and temporal variability of temperature and of the carbonate system often already exceed the mean of anticipated future scenario changes. In addition, mixing of these factors and their variation could lead to unexpected organism responses [@Kroeker2016-ma]. This raises the important question of what influence environmental variability through time and space has at the species, community or ecosystem level [@Kroeker2020-uq]. Early efforts to answer this question suggested a significant effect of natural variability on individual species and the ecosystem, emphasizing the non-linear relationship between environmental stressors and biological response [@Bernhardt2018-fp; @Harley2017-so; @Kroeker2016-ma]. Accordingly, more complex *in situ* studies have begun to highlight the complexities of the multitude of possible interactions between biological and environmental factors in the mean response and variability to a changing climate system [@Ashton2017-cm; @Barnes2021-ju]. A novel approach to account for the inherent complexity of marine ecosystems is the use of archival museum collections to study phenotypic responses to historical changes in a particular species or populations [@Bullard2021-lk; @Cross2018-bw; @Telesca2021-zm]. This approach offers a unique way to study organism responses, as it observes outcomes that by their nature include all natural organism-organism and organism-environment interactions at every given time interval. This allows the identification of organism or population responses in complex natural systems over significantly longer time frames, allowing us to extend the understanding gained from laboratory or in situ experiments.

The intertidal zone is a harsh and demanding environment in which sessile or slow-moving inhabitants such as the gastropod *Nucella lapillus* (Linnaeus, 1758) (dog whelk) are regularly exposed to a range of biotic and abiotic stressors including varying water levels, wave action, air exposure, steep salinity gradients, large temperature variation and changing predator regimes. Salinity levels in tidal pools may change rapidly depending on external factors such as evaporation, precipitation or ice encasement [@Clarke2020-fh]. Lacking the ocean’s heat capacity which buffers short-term temperature fluctuation, intertidal organisms exposed to air and direct solar insolation have to endure excessive heat which may be intensified in shelled organisms [@Clark2021-hy; @Thyrring2017-sd]. In terms of global climate change, the intertidal zone is considered one of the most vulnerable areas as the interaction between global temperature rise and tidal movement may create a mosaic-like thermal environment that can be detrimental to intertidal organisms through e.g., cardiac arrest or protein damage [@Angilletta2013-ie; @Hofmann1995-yv; @Roberts1997-hi]. In addition, global climate change is expected to cause more extreme weather conditions [@Easterling2000-cw; @Meehl2004-ur; @Rahmstorf2011-rh; @Rummukainen2012-ej] which will be accompanied by more regular and more intense storm events, putting intertidal organisms at additional risk [@Nehls1993-lz]. Intertidal organisms are adapted to hostile conditions but an increase in the occurrence or duration of spatial and temporal stressor extremes provoked by global climate change may exceed their tolerance limits. In addition to the natural stressors, anthropogenic interactions with the environment through e.g., ship traffic, communal waste discharge, mining, tourism and agricultural land use further exacerbate the hostility of the intertidal zone. For example, increased land use for agricultural purposes and associated use of fertilisers resulted in a significant nutrients burden of riverine input into the North Sea [@Brion2008-na]. This resulted in eutrophication of the near shore accompanied by an increase in primary production [@Brion2008-na; @Gypens2009-ok; @Mackenzie2002-gg].

The carnivorous gastropod *Nucella lapillus* is an important predator in the intertidal zone [@Burrows1989-gi; @Hughes1994-qn]. It is highly abundant on rocky shores in the Northern Atlantic and is, as an intertidal dweller, regularly exposed to air and extreme wave regimes. Due to its pronounced shell plasticity along environmental gradients such as wave energy and predator abundance [@Palmer1990-qn; @Pascoal2012-od] it has been the focus of numerous studies. Its calcareous shell consists of two distinct layers; irregular calcite externally and crossed lamellar aragonite internally which may be separated by a transitional spherulitic layer [@Mayk2020-ko]. The shell exhibits a high degree of variability in morphology [@Berry2009-ql; @Crothers1985-cq; @Galante-Oliveira2011-ux], apertural teeth expression [@Appleton1988-zb; @Cowell1970-jq](Appleton & Palmer, 1988; Cowell & Crothers, 1970; Palmer, 1990) and most notably shell thickness [@Appleton1988-zb; @Currey1982-mu; @Hughes1979-qc; @Palmer1990-qn @Pascoal2012-od; @Vermeij1980-jt] in accordance with environmental stressors. These characteristics make *N. lapillus* a valuable candidate to study the impact of long-term environmental change on intertidal calcifiers.

# Materials and Methods

## Sample area and collection

``` {r, message=FALSE, echo=FALSE} 
mean_shell_size <- read_delim("../data/shell/shell_shape.csv") %>%
  summarise(avg = round(mean(shell_height, na.rm = T), 2),
            stdev = round(sd(shell_height, na.rm = T), 2),
            n = n())
```

Specimens were collected from seven sites along the Belgian and Dutch coast (Supplementary Table 1) between 1888 and 2019 and archived at the Royal Belgian Institute of Natural Sciences, Brussels, Belgium (RBINS). Archival specimens were either stored dry or wet in ethanol (70%) filled preservation jars. The total sampling area extends over $\sim49$ km from the port of Oostende (51°14'N 2°55'E) across the Westerschelde estuary to the beach of Zoutelande (51°29'N 3°28'E) (Supplementary Figure 2a). The Belgian coast is dominated by wide sandy beaches with little hard substratum, rendering it generally unsuitable habitat for barnacles, mussels, or the predatory *N. lapillus*. However, the extensive construction of man-made structures against coastal erosion, wave exposure and flooding such as groynes, port structures, and dikes provide excellent substrata for rocky shore organisms and allowed the development of successful populations of these organisms on the Belgian and Dutch coast. 
In this study a total of `r mean_shell_size$n` *N. lapillus* specimens were analysed. Only archival specimens with detailed collection date and location descriptions were included. No samples were available between 1978 and 2019 due to the extensive use of the organotin-compound tributyltin (TBT) as an antifouling agent on ships that caused imposex in female *N. lapillus* [@Gibbs1991-rr; @Gibbs1999-qr; @Oehlmann1998-zg]. The use of TBT led to a local extinction of *N. lapillus* on the Belgian coast in the late 1970s [@Kerckhof1988-pz], and they only reappeared in 2012 [@De_Blauwe2012-gg]. All specimens collected were adults (likely at sexual maturity) with shell heights > 17 mm [@Galante-Oliveira2010-ha]. The average shell height of selected specimens was `r mean_shell_size[1]` ± `r mean_shell_size[2]` mm (1$\sigma$). Shells selected for this study had intact apices and showed no exterior and interior signs of dissolution nor other apparent shell damage. 

## Environmental dataset

To investigate changes in environmental stressors along the Belgian coast over the last 130 years, four key environmental parameters (wind speed, air temperature, sea surface temperature, sea surface salinity) were investigated. Detailed descriptions of the datasets are provided in the supplementary material. Long-term time series of monthly measurements for wind speed, sea surface temperature and air temperature from 1880 – 2020 in the area of 51º – 52º N and 2º – 4º E were obtained from the International Comprehensive Ocean-Atmosphere Data Set 3.0 [@National_Centers_for_Environmental_InformationNESDISNOAAUS_Department_of_Commerce2016-ey]. This dataset provides assimilated original marine surface data with traceable data sources and thus provides a reliable source with exceptionally high spatial and temporal resolution. Data for salinity from 1961 – 2018 were obtained from the ICES Dataset on Ocean Hydrography, 2020 [@Ices2020-be]. Since near-shore salinity regimes generally exhibit a mosaic pattern due to differences in surface and underground freshwater run-offs, salinity differences between sampling sites are much higher than expected decadal changes. In addition, the ICES data did not allow for the construction of reliable time series at every sampling site, hence median salinities of all available data points within a 10 km radius around either sampling site are reported and compared. Inspection of the salinity data showed that these were neither normally distributed (Shapiro Wilk test and visual inspection with QQ plots) nor exhibited an equal variance (Levene’s test and visual inspections of the residuals). Hence, differences in salinity between sampling sites were evaluated by a non-parametric Kruskal-Wallis H test and a pairwise Wilcoxon Rank Sum post-hoc test with a standard Bonferroni correction.
Changes in seawater pH could not be directly assessed as there is a lack of reliable long-term pH trends for the (Southern) North Sea [@Ostle2016-kg]. It is suggested that tracing long term trends in the seawater carbonate system requires data sets of at least 25 years [@Fay2013-vi] which are not available for the sampling sites. 

## Shell characteristics

``` {r, message=FALSE, echo=FALSE} 
nucella_thickness <-
  read_delim("../data/shell/nucella_thickness.csv")
rep_test <-
  kruskal.test(aragonite_thickness_um / calcite_thickness_um ~ session, data = nucella_thickness)

rep_test_H <- round(as.numeric(rep_test[1]), 3)
rep_test_df <- as.numeric(rep_test[2])
rep_test_p <- round(as.numeric(rep_test[3]), 3)
if (rep_test_p > 0.001) {
  rep_test_p <-
    paste("=", rep_test_p, sep = " ")
} else {
  rep_test_p <- "< 0.001"
}
```

For all specimens, measurements of shell height, aperture height and aperture width were made using digital Vernier callipers (±0.1 mm). Shell shape was evaluated using elliptic Fourier analysis (EFA) of shell outlines [@Giardina1977-jo; @Kuhl1982-jb] following the approach in @Telesca2018-oo. For this, individual shells were placed on an illuminated platform with the aperture facing downward in a natural position and images were taken from a fixed distance with a DSLR camera (Nikon 3000 with a Sigma 105 mm macro lens) mounted on a photostand. This produced images of the shells as black silhouettes with sharp edges on a bright background making them suitable for outline tracing. We constructed the outlines in a natural position (i.e., aperture facing downward) rather than in the more commonly used aperture upwards position to study shape changes that are meaningful to *N. lapillus* in a natural setting. Outlines of individual shells were digitised and turned into x-y coordinates using the R package Momocs [@Bonhomme2014-jj; @R_Core_Team2020-ph]. Outlines were subsequently smoothed to remove digitisation noise and harmonised regarding orientation and size by Procrustes analysis. An EFA was then carried out on the aligned outlines with nine harmonics encompassing 99% of the total harmonic power and a principal component analysis (PCA) was used to extract axes that reflect most of the shell shape variability among individuals.
Shell layer thickness was analysed by sectioning the shells perpendicular to the aperture at the mid-section of the last whorl using a diamond saw (Figure 1a). The anterior side was embedded in polyester resin (Kleer-Set FF, MetPrep, Coventry, UK). The intersection plane of embedded specimens was smoothed on silicon carbide paper and subsequently polished down to one micron with diamond paste using an automated polishing rig. Micrographs of the shell sections were taken from the dorsal region (Figure 1a) of the shell halves using a digital stereo microscope (ZEISS Primo Star, Zeiss, Oberkochen, Germany). Since aperture thickness is influenced by both predation pressure and wave exposure in *N. lapillus* through the formation of thicker apertural lips and/or teeth [@Appleton1988-zb; @Avery2006-zf; @Palmer1990-qn; @Pascoal2012-od], measurements of shell layer thickness further inside the shell provides a better proxy for environmentally induced shell layer thickness variability. Aragonite and calcite layer thicknesses were individually measured from 10 randomly chosen regions within the micrographs using the software ZEISS Labscope (v.3.1). For this purpose, ten approximately equally distanced sections were selected on either micrograph and total shell thickness and calcite layer thickness were measured perpendicular to the innermost aragonite layer of the shells. Aragonite layer thickness was inferred by subtracting calcite layer thickness from total shell thickness. To validate the reproducibility of this method the same images were evaluated three times in different orders and on different days showing no statistically significant difference between measurement sessions (Kruskal-Wallis H test, H(`r rep_test_df`) = `r rep_test_H` *p* `r rep_test_p`). 

``` {r fig_1, echo=FALSE, message = FALSE, fig.height = 7, fig.width = 3.5, fig.cap = "Shell layer thickness trends in archived *Nucella lapillus* from the Belgian and Dutch coasts over the last 130 years. (a) Indication of a shell section used for the thickness analysis. The dorsal region where thickness measurements were carried out is highlighted in red. (b) GAM thickness trend of the crossed lamellar aragonite layer (red) and thickness trend of the irregular prismatic calcite layer (blue). (c) GAM shell height (green) and aperture size (brown) trends. 95% confidence intervals are represented by shaded areas."}
knitr::include_graphics("../plots/figure_1.pdf")
```

## Environmental timeseries analysis

Long term time series (1880 - 2020) of sea surface temperature, air temperature and wind speed were modeled with generalised additive mixed models (GAMM) using the R package mgcv [@Wood2011-ui] and following protocols for data exploration and regression-type analyses [@Zuur2010-tn; @Zuur2016-hk]. Each dependent variable was modeled using month and year as fixed covariates and their tensor product interaction term. The final model was of the form:

$$
ED_i = \beta_0 + f(month_i) + f(year_i) + f(month_i, year_i) + \epsilon_i
$$
$$
\epsilon_i \sim N(0; \sigma^2)
$$

Where $ED_i$ is the $i^{th}$ observation of the time series, $\beta_0$ is the intercept, $f(month_i)$ and $f(year_i)$ are smooth functions of months and years, $f(month_i, year_i)$ is the interaction term of the two variables and $\epsilon_i$ is the normally distributed and correlated error term. For both smooth terms thin plate regression splines were used, and the number of knots for months was limited to 12. Plots of the partial autocorrelation function showed significant autocorrelation of the residuals which required the use of autoregressive models to account for the temporal autocorrelation. 
To identify significant trend changes in the modeled time series the first derivative of the fitted model was calculated using finite differences. Since the equation of the regression splines is unknown, finite differences provide a method to resample a fitted spline with a chosen number of points. This enabled us to calculate the first derivative of a fitted regression line through these resampled points which resembles a close approximation of the fitted spline. 

We also estimated yearly calcification windows (i.e., days per year when mean temperatures reach a certain threshold) from monthly mean and standard deviation temperature. It is well known that biomineralization rates are halted or greatly reduced when the environmental temperature falls below an organism or population specific temperature threshold [@Doroudi1999-ao; @Joubert2014-vf; @Laing2000-wd]. In laboratory experiments *N. lapillus* from the coast of Whitby, UK showed a calcification threshold temperature of $\sim13$ °C (below 13 °C no noticeable calcification occurred; D.M. personal observation). To account for possible differences in temperature tolerances between *N. lapillus* populations in the UK and the sampling site on the Southern North Sea coast, yearly calcification windows were estimated for temperature thresholds of 10 °C to 15 °C in 1 °C increments (Figure 2). Number of days per year exceeding the threshold temperature were then modeled using generalized additive models (GAM) of the form:


$$
CTD_i = \beta_0 + f(year_i) * ct + ct + no + \epsilon_i
$$
$$
\epsilon_i \sim N(0; \sigma^2)
$$

Where $CTD_i$ is the $i^{th}$ observation of the time series, $\beta_0$ is the intercept, $f(year_i)$ is the smooth function of years, $ct$ represents the selected calcification thresholds and $no$ refers to the number of observations per year.

## Shell characteristics timeseries analysis 
Selected shell shape and thickness descriptors, namely shell height, aperture size, shape-PC1 - shape-PC4, calcite layer thickness and aragonite layer thickness were modeled by GAMs to identify significant changes among sampling locations, shell size and through time. GAMs included years to model long-term trends among shell descriptors, shell height to account for morphological and compositional variability caused by a difference in size among individuals which was important to avoid biases due to allometric scaling, and sampling site as random-effect to account for sampling sites specific effects such as wave, salinity or predation exposure on the dependent variable. The final model was of the form: 

$$
SD_{ij} = \beta_0 + f(year_i) + f(shell\:height_{ij}^*) + site_i + \epsilon_{ij}
$$
$$
site_i \sim N(0; \sigma^2)
$$
$$
\epsilon_{ij} \sim N(0; \sigma^2)
$$

Where $SD_j$ is the $j^{th}$ observation of the shell descriptor in site i (i = 1-7), $\beta_0$ is the intercept, $f$ are the smoothing functions, $site_i$ is the random-effect and $\epsilon_i$ is the normally distributed error term. The asterisk denotes that this term was not included in the GAM modeling shell height trends. 

## Global timeseries analysis 

The effect of long-term environmental change in wind speed, sea surface temperature, and air temperature on the selected shell characteristics were analysed by a sequence of global models. Therefore, descriptive statistics for each environmental variable were calculated (i.e., mean, median, min, max, $10^{th}$ percentile, $25^{th}$ percentile, $75^{th}$ percentile, $90^{th}$ percentile and standard deviation). To account for the natural variability spectrum that individual specimens experienced throughout their lifetime the descriptive statistics were calculated for a time window encompassing three years up to the sampling year of the respective samples. A PCA was then performed on the normalized descriptive statistics for each environmental parameter to describe temperature and wind speed “regimes” (Figure 2) [@Kroeker2016-ma; @Telesca2021-zm]. This provides the benefit of reducing dimensionality in the data and allows to model complex relationships while avoiding collinearity among explanatory variables. GAMs were then constructed for each selected shell characteristic including the first two principal components of each environmental parameter as independent variables. An automated variable selection process using the "preferred" double penalty approach [@Marra2011-ko] was used to select covariables with the most influence on the response variable. Sampling site was included in all models as random effect.   

``` {r, echo=FALSE, message = FALSE, label = "figure_1", fig.cap = "Biplots of sea surface temperature, air temperature and wind speed regimes at the Belgian coast from 1890 until 2019. (a) Biplot of a principal component analysis of descriptive statistics for sea surface temperature covering 66.2 % of the total variability. (b) PCA biplot of air temperature covering 74.7 % of the total variability and (c) PCA biplot of wind speed covering 93.2 % of the total variability."}
knitr::include_graphics("../plots/figure_2.pdf")
```

# Results

## Environmental change

``` {r, message=FALSE, echo=FALSE, warnings=FALSE} 
gamm_air_temp <- readRDS("../data/env/GAMM_air_temp.rds")
belgium_air_temperature <-
  read_delim("../data/env/air_temperature_comp.csv")

pdat_air_temp <-
  data.frame(
    year = unique(belgium_air_temperature$year),
    month = mean(belgium_air_temperature$month)
  )

pred_air_temp <-
  predict(
    gamm_air_temp$gam,
    newdata = pdat_air_temp,
    exclude = "month",
    type = "response",
    se.fit = T
  )

predframe_air_temp <- data.frame(
  year = pdat_air_temp$year,
  pred_air_temp = pred_air_temp[[1]],
  se_air_temp = pred_air_temp[[2]]
)

air_temp_edf <-
  round(as.numeric(anova(gamm_air_temp$gam)$s.table[1, 1]), 2)
air_temp_F <-
  round(as.numeric(anova(gamm_air_temp$gam)$s.table[1, 3]), 2)
air_temp_p <-
  round(as.numeric(anova(gamm_air_temp$gam)$s.table[1, 4]), 3)
if (air_temp_p > 0.001) {
  air_temp_p <-
    paste("=", air_temp_p, sep = " ")
} else {
  air_temp_p <- "< 0.001"
}
air_temp_diff <-
  round(max(predframe_air_temp$pred_air_temp) - min(predframe_air_temp$pred_air_temp),
        0)

gamm_sea_temp <- readRDS("../data/env/GAMM_sea_temp.rds")
belgium_sea_temperature <-
  read_delim("../data/env/sea_surface_temperature.csv")

pdat_sea_temp <-
  data.frame(
    year = unique(belgium_sea_temperature$year),
    month = mean(belgium_sea_temperature$month)
  )

pred_sea_temp <-
  predict(
    gamm_sea_temp$gam,
    newdata = pdat_sea_temp,
    exclude = "month",
    type = "response",
    se.fit = T
  )

predframe_sea_temp <- data.frame(
  year = pdat_sea_temp$year,
  pred_sea_temp = pred_sea_temp[[1]],
  se_sea_temp = pred_sea_temp[[2]]
)

sea_temp_edf <-
  round(as.numeric(anova(gamm_sea_temp$gam)$s.table[1, 1]), 2)
sea_temp_F <-
  round(as.numeric(anova(gamm_sea_temp$gam)$s.table[1, 3]), 2)
sea_temp_p <-
  round(as.numeric(anova(gamm_sea_temp$gam)$s.table[1, 4]), 3)
if (sea_temp_p > 0.001) {
  sea_temp_p <-
    paste("=", sea_temp_p, sep = " ")
} else {
  sea_temp_p <- "< 0.001"
}
sea_temp_diff <-
  round(max(predframe_sea_temp$pred_sea_temp) - min(predframe_sea_temp$pred_sea_temp),
        0)

gamm_wind_speed <- readRDS("../data/env/GAMM_wind_speed.rds")
belgium_wind_speed <- read_delim("../data/env/wind_speed_comp.csv")

pdat_wind_speed <-
  data.frame(
    year = unique(belgium_wind_speed$year),
    month = mean(belgium_wind_speed$month)
  )

pred_wind_speed <-
  predict(
    gamm_wind_speed$gam,
    newdata = pdat_wind_speed,
    exclude = "month",
    type = "response",
    se.fit = T
  )

predframe_wind_speed <- data.frame(
  year = pdat_wind_speed$year,
  pred_wind_speed = pred_wind_speed[[1]],
  se_wind_speed = pred_wind_speed[[2]]
)

wind_speed_edf <-
  round(as.numeric(anova(gamm_wind_speed$gam)$s.table[1, 1]), 2)
wind_speed_F <-
  round(as.numeric(anova(gamm_wind_speed$gam)$s.table[1, 3]), 2)
wind_speed_p <-
  round(as.numeric(anova(gamm_wind_speed$gam)$s.table[1, 4]), 3)
if (wind_speed_p > 0.001) {
  wind_speed_p <-
    paste("=", wind_speed_p, sep = " ")
} else {
  wind_speed_p <- "< 0.001"
}
wind_speed_diff <-
  round(
    max(predframe_wind_speed$pred_wind_speed) - min(predframe_wind_speed$pred_wind_speed),
    0
  )
```

Long-term models of selected environmental parameters reveal an increase in air temperature, sea surface temperature and wind speed from 1880 to 2020 (Figure 3, Supplementary Table 2). Mean air temperature increased significantly ($F_{`r air_temp_edf`}$ = `r air_temp_F`, p `r air_temp_p`) by `r air_temp_diff` ºC. Mean sea surface temperature increased significantly ($F_{`r sea_temp_edf`}$ = `r sea_temp_F`, p `r sea_temp_p`) by `r sea_temp_diff` ºC with a rapid acceleration of warming since 1985 to the present. The winter months of December to February exhibit the most pronounced increase in temperature throughout the time-series (Supplementary Figure 4). Wind speed exhibited an initial drop from 1880 to 1930 by about 2 $ms^{-1}$ after which it rose significantly ($F_{`r wind_speed_edf`}$ = `r wind_speed_F`, p `r wind_speed_p`) by `r wind_speed_diff` $ms^{-1}$. 

``` {r, echo=FALSE, message = FALSE, fig.height = 3.5, fig.cap = "Historical trends of (a) air temperature, (b) sea surface temperature and (c) wind speed within the sampling region from 1880 to 2020. For each environmental parameter both the overall change including all individual data points (bottom panels) and the temporal change centred around the maximum variability (top panel) are presented. Coloured lines mark periods of significant increases (red) or decrease (blue). 95% confidence intervals (shaded area) are reported for each predictor (dashed lines)."}
knitr::include_graphics("../plots/figure_3.pdf")
```

``` {r, message=FALSE, echo=FALSE, warnings=FALSE} 
belgium_salinity <- read_delim("../data/env/salinity_comp.csv")

comp_loc <- kruskal.test(sal ~ location, data = belgium_salinity)

comp_loc_H <- round(as.numeric(comp_loc[1]), 3)
comp_loc_df <- as.numeric(comp_loc[2])
comp_loc_p <- round(as.numeric(comp_loc[3]), 3)
if (comp_loc_p > 0.001) {
  comp_loc_p <-
    paste("=", comp_loc_p, sep = " ")
} else {
  comp_loc_p <- "< 0.001"
}

pair_loc <-
  pairwise.wilcox.test(belgium_salinity$sal,
                       belgium_salinity$location,
                       p.adjust.method = "BH")

ZWA_sal <-
  round(median(filter(belgium_salinity, location == "ZWA")$sal, na.rm = T), 1)
OST_sal <-
  round(median(filter(belgium_salinity, location == "OST")$sal, na.rm = T), 1)
DUI_sal <-
  round(median(filter(belgium_salinity, location == "DUI")$sal, na.rm = T), 1)
KNO_sal <-
  round(median(filter(belgium_salinity, location == "KNO")$sal, na.rm = T), 1)
BLA_sal <-
  round(median(filter(belgium_salinity, location == "BLA")$sal, na.rm = T), 1)
ZEE_sal <-
  round(median(filter(belgium_salinity, location == "ZEE")$sal, na.rm = T), 1)
ZOU_sal <-
  round(median(filter(belgium_salinity, location == "ZOU")$sal, na.rm = T), 1) 
```

Salinity data comparison by Kruskal-Wallis rank sum test confirmed the anticipated significant inhomogeneity between sampling sites (H(`r comp_loc_df`) = `r comp_loc_H` *p* = `r comp_loc_p`). A pairwise Wilcoxon rank sum test with Bonferroni adjusted p-values for a pairwise comparison of median salinities between each sampling site (Supplementary Table 3) reported that the median salinity of `r ZWA_sal` psu at Zwarte Polder was significantly lower than at the other sites. Median salinities at Blankenberge (`r BLA_sal` psu), Zeebrugge (`r ZEE_sal` psu), Duinbergen (`r DUI_sal` psu) and Knokke (`r KNO_sal` psu) were not significantly different due to the proximity of these sites. Oostende exhibited a median salinity of `r OST_sal` psu which is `r OST_sal-ZWA_sal` psu higher than at Zwarte Polder and significantly higher than at all other sites. 

``` {r, message=FALSE, echo=FALSE} 
calc_win <-
  read_delim("../data/env/calcification_percent_estimates.csv")

min_change <- round(min(calc_win$percent_change), 0)
max_change <- round(max(calc_win$percent_change), 0)
```

Calcification windows significantly increased non-linear from 1880 until 2019 irrespective of selected temperature threshold (Figure 4, Table 1). The percentage increases of days per year above temperature thresholds (10 °C – 15 °C) range between `r min_change` % to `r max_change` %. The biggest percentage increase was found in the 15 °C temperature threshold group which means that days reaching sea surface temperatures of 15 °C occurred more than double as often in 2019 than in 1880.

``` {r, echo = FALSE, message = FALSE, fig.height = 5, fig.width = 3.5, fig.cap = "Calcification window change estimates. (a) Historical trends of estimated calcification window length per year expressed as the number of days in which the sea surface temperature surpassed a selected threshold. 95% confidence intervals (shaded area) are reported for each predictor (dashed lines). (b) Absolute and relative change in days surpassing temperature threshold between 1890 and 2019. "}
knitr::include_graphics("../plots/figure_4.pdf")
```

## Long-term trends of shell formation

``` {r, message=FALSE, echo=FALSE} 
get_gam_sum <- function(model) {
  m_edf <- round(as.numeric(anova(model)$s.table[1, 1]), 2)
  m_F <- round(as.numeric(anova(model)$s.table[1, 3]), 2)
  m_p <- round(as.numeric(anova(model)$s.table[1, 4]), 3)
  if (m_p > 0.001) {
    m_p <- paste("=", m_p, sep = " ")
  } else {
    m_p <- "< 0.001"
  }
  return(c(m_edf, m_F, m_p))
}

gam_PC1 <- readRDS("../data/shell/GAM_shape_PC1.rds")
gam_PC2 <- readRDS("../data/shell/GAM_shape_PC2.rds")
gam_PC3 <- readRDS("../data/shell/GAM_shape_PC3.rds")
gam_PC4 <- readRDS("../data/shell/GAM_shape_PC4.rds")

sum_gam_PC1 <- get_gam_sum(gam_PC1)
sum_gam_PC2 <- get_gam_sum(gam_PC2)
#sum_gam_PC3 <- get_gam_sum(gam_PC3)
sum_gam_PC4 <- get_gam_sum(gam_PC4)

min_r <- round(min(c(
  summary(gam_PC1)$r.sq,
  summary(gam_PC2)$r.sq,
  summary(gam_PC4)$r.sq
)) * 100, 1)
max_r <- round(max(c(
  summary(gam_PC1)$r.sq,
  summary(gam_PC2)$r.sq,
  summary(gam_PC4)$r.sq
)) * 100, 1)

nucella_coe <- readRDS("../data/shell/nucella_coe_object.rds")
nucella_pca <- PCA(nucella_coe)

```

Shell shape PCs of *N. lapillus* significantly changed with sampling year (shape-PC1: $F_{`r sum_gam_PC1[1]`}$ = `r sum_gam_PC1[2]`, p `r sum_gam_PC1[3]`; shape-PC2: $F_{`r sum_gam_PC2[1]`}$ = `r sum_gam_PC2[2]`, p `r sum_gam_PC2[3]`; shape-PC4: $F_{`r sum_gam_PC4[1]`}$ = `r sum_gam_PC4[2]`, p `r sum_gam_PC4[3]`) (Figure 5, Supplementary Figure 1). The first four principal components (shape-PC1 - shape-PC4) capture `r round(summary(nucella_pca)$importance[3,4]*100,0)` % of the total shape variance among specimens. The most pronounced shell shape variability between individuals captured by shape-PC1 is an inclination of the longitudinal axis whereby variability captured by shape-PC2 describes a rounding of the shell. Shape-PC3 describes the shape of the shells' apices and shape-PC4 describes the angularity of the shells (Figure 5). Unlike the other shape descriptor, shape-PC3 did not significantly change over the past 130 years and was therefore omitted from further analysis. Despite their significance, the deviance explained by the shape GAMs is low in all models ($R^2$: `r min_r` - `r max_r`), suggesting that other unaccounted factors had a strong influence on the shell shape of the herein studied *N. lapillus* specimens. All models performed significantly better than the respective intercept-only model.

``` {r, echo = FALSE, message = FALSE, warning=FALSE, fig.width = 5, fig.height = 4, fig.cap = "Shell shape trends of significant shape descriptors (a) shape-PC1, (b) shape-PC2 and (c) shape-PC4 in the intertidal gastropod *Nucella lapillus* from the Belgian and Dutch coast collected between 1888 and 2019. Shape variance ($\\overline{x} \\pm 3\\sigma$) represented by either shape-PC is presented in (d)."}
knitr::include_graphics("../plots/figure_5.pdf")
```

``` {r, message=FALSE, echo=FALSE} 
gam_calcite <- readRDS("../data/shell/GAM_calcite_thickness.rds")
gam_aragonite <-
  readRDS("../data/shell/GAM_aragonite_thickness.rds")
gam_aperture <- readRDS("../data/shell/GAM_aperture_size.rds")
gam_height <- readRDS("../data/shell/GAM_shell_height.rds")
nucella_shape <- read_delim("../data/shell/shell_shape.csv")

get_gam_sum <- function(model) {
  m_edf <- round(as.numeric(anova(model)$s.table[1, 1]), 2)
  m_F <- round(as.numeric(anova(model)$s.table[1, 3]), 2)
  m_p <- round(as.numeric(anova(model)$s.table[1, 4]), 3)
  if (m_p > 0.001) {
    m_p <- paste("=", m_p, sep = " ")
  } else {
    m_p <- "< 0.001"
  }
  return(c(m_edf, m_F, m_p))
}

predict_gam <- function(model) {
  kachy <-
    with(nucella_shape,
         data.frame(
           year = seq(min(year), max(year), length = 1000),
           shell_height = median(nucella_shape$shell_height),
           location = "ZEE"
         ))
  
  pred <-
    predict(
      model,
      newdata = kachy,
      exclude = "location",
      type = "response",
      se.fit = T
    )
  predframe <- data.frame(year = kachy$year,
                          pred = pred$fit,
                          se = pred$se.fit)
  return(predframe)
}


# Get model statistics
sum_gam_calcite <- get_gam_sum(gam_calcite)
sum_gam_aragonite <- get_gam_sum(gam_aragonite)
sum_gam_aperture <- get_gam_sum(gam_aperture)
sum_gam_height <- get_gam_sum(gam_height)

# Predict models
predframe_calcite <- predict_gam(gam_calcite)
predframe_aragonite <- predict_gam(gam_aragonite)
predframe_apt <- predict_gam(gam_aperture)
predframe_height <- predict_gam(gam_height)

# How much did shell layer thickness change?
abs_arag <- round(exp(max(predframe_aragonite$pred)) -
                    exp(min(predframe_aragonite$pred)), 2)

rel_arag <- round(((exp(
  max(predframe_aragonite$pred)
) -
  exp(
    min(predframe_aragonite$pred)
  )) /
  exp(min(
    predframe_aragonite$pred
  ))) * 100, 0)

abs_calc <- round(exp(max(predframe_calcite$pred)) -
                    exp(min(predframe_calcite$pred)), 2)

rel_calc <- round(((exp(
  max(predframe_calcite$pred)
) -
  exp(
    min(predframe_calcite$pred)
  )) /
  exp(min(
    predframe_calcite$pred
  ))) * 100, 0)

abs_apt <- round(max(predframe_apt$pred) -
                   min(predframe_apt$pred), 2)

rel_apt <- round(((
  max(predframe_apt$pred) -
    min(predframe_apt$pred)
) /
  min(predframe_apt$pred)) * 100, 0)

abs_sh <- round(max(predframe_height$pred) -
                  min(predframe_height$pred), 2)

rel_sh <- round(((
  max(predframe_height$pred) -
    min(predframe_height$pred)
) /
  min(predframe_height$pred)) * 100, 0)
```

Total shell layer thickness significantly increased from 1888 to 2019. Aragonite layer thickness significantly increased by `r abs_arag` mm ($F_{`r sum_gam_aragonite[1]`}$ = `r sum_gam_aragonite[2]`, p `r sum_gam_aragonite[3]`), i.e., by `r rel_arag` %. Calcite layer thickness also increased significantly by `r abs_calc` mm ($F_{`r sum_gam_calcite[1]`}$ = `r sum_gam_calcite[2]`, p `r sum_gam_calcite[3]`), i.e., by `r rel_calc`%. Aperture size increased significantly between 1888 and 2019 ($F_{`r sum_gam_aperture[1]`}$ = `r sum_gam_aperture[2]`, p `r sum_gam_aperture[3]`) by `r abs_apt` $mm^2$, i.e., by `r rel_apt` %. Mean shell height significantly increased by up to `r rel_sh`  % ($F_{`r sum_gam_height[1]`}$ = `r sum_gam_height[2]`, p `r sum_gam_height[3]`) (Figure 1).  Shell layer thickness, shell height and aperture size models performed significantly better than the intercept-only models. GAM summary statistics of shell shape and thickness models are provided in Supplementary Table 4. 

## Environmental impact on shell calcification

Global GAMs with automated model term selection suggest varying influences of environmental regimes on selected shell characteristics (Figure 6). Shell height and aperture size  are significantly influenced by air temperature, sea surface temperature and wind speed. Aragonite layer thickness  in the studied specimens significantly correlated with sea surface temperature and wind speed. Calcite layer thickness is significantly influenced only by air temperature. All shape-PCs correlated significantly with sea surface temperature. Furthermore, shape-PC2 correlated significantly with wind speed and shape-PC4 correlated significantly with air temperature. Among selected shell descriptors only aragonite layer thickness and shell height varied significantly with sampling sites. GAM summary statistics of global models are provided in Supplementary Table 5.

``` {r, echo = FALSE, message = FALSE, warning=FALSE, fig.height = 3.5, fig.width = 3.5, fig.cap = "Correlation matrix of global model outputs for selected shell characteristics. Y-axis shows model terms and x-axis represents the dependent variables (shell shape and thickness descriptors). Color intensity reflects significance of correlation given by the models' *p*-values; with darker colours representing lower *p*-values. Non-significant model terms (*p* > 0.05) are represented by blanks. Floating bar shows the deviance explained per model in percent. Color intensity reflects the amount of deviance explained, with darker colours referring to higher percentage of deviance explained."}
knitr::include_graphics("../plots/figure_6.pdf")
```

# Discussion

Contrary to expected species responses to global climate change [@Gazeau2013-cs], we found significant increases in shell layer deposition in archival *N. lapillus* from the Belgian and Dutch North Sea coast from 1888 until 2019. In relative terms, aragonite layer thickness increased twice as much as calcite layer thickness although in absolute terms calcite thickness increased more (Figure 1). Similar shell layer thickening was also reported in the blue mussel *Mytilus edulis* over the last century that had been sampled from adjacent regions [@Telesca2021-zm]. Unlike reported apertural lip thickening observed in archival *N. lapillus* from the US east coast that scaled solely with shell height [@Fisher2009-dv], our shell thickness descriptors showed only weak allometric relationships and correlated significantly with sampling years (Figure 1, Supplementary Table 4). 
We also found significant shell shape changes as well as aperture size and shell height increases over the last 130 years. Most noticeable, shape changes included a shift in the shells' longitudinal axis that correlated significantly with sea surface temperature and explained almost 80% of the total shape variance (Figure 5 and 6). However, a similar association between axis orientation and temperature has not been presented in the literature so far and it is at this point unclear if the link between the two is causal.
Few studies have so far investigated shell size changes in *N. lapillus* of decade or century long time frames and available studies present conflicting results. For example, a study of archival *N. lapillus* from the US east coast reports a century long shell height increase [@Fisher2009-dv] but another study of archival *N. lapillus* from the Southern UK coast reports significant shell height decreases. Generally, museum collections complicate the interpretation of *absolute* changes due to possible sample collection biases. However, both conflicting studies had access to exceptionally large sample sizes mitigating the risk for collection biases which suggests a possible locality effect. In fact, GAMs (Figure 6) suggest a strong relationship between shell height and sampling location, possibly driven by differences in wave exposure or predation regimes (Crothers 1983, Colton 1922, Colton 1916, Berry 2009. 

## Constraints on shell biomineralization

Shell formation through calcium carbonate precipitation is most influenced by three factors: temperature [@Clarke1993-lx; @Watson2012-fy], ion availability ($Ca^{2+}$ and $HCO_3^-$) [@Sanders2021-gf] and the nutritional state of the organism, as shell formation comes with metabolic energy cost [@Palmer1983-nq; @Palmer1992-uz; @Watson2017-lv]. Estimates for the amount of energy required to produce a unit of shell varies largely between studies but may be as large as $\sim60$ % of the available assimilated energy in e.g., blue mussels from the Baltic Sea and thus can contribute significantly to an organism’s energy balance [@Sanders2018-gr]. Low temperatures decrease precipitation rates of calcium carbonates [@Burton1987-vn] and may impair important cellular processes rendering warmer temperatures more preferential for shell formation. Low calcium and/or (hydrogen-) bicarbonate ion availability, which are the building blocks of calcium carbonate may also impair shell production rates. For example, low calcium ion concentrations in the Baltic Sea impair shell formation in mytilid mussels [@Sanders2021-gf] and OA causes a change in the seawater carbonate system shifting the equilibrium towards carbonic acid, also impeding the formation of calcium carbonates. High latitude calcifiers mitigate these limitations by incorporating a larger proportion of organic material into their shell which in turn comes with an increase in metabolic cost per unit shell [@Palmer1992-uz; @Sanders2018-gr; @Telesca2019-ua]. Stress due to increasing wave action or increasing predator abundance may also affect shell formation rates. *Nucella lapillus* responds to enhanced predator abundance by making thicker apertural lips and increasing apertural teeth abundance [@Appleton1988-zb]. A study of shell layer thickening in archival blue mussels from adjacent sites on the Belgian coast identified significant increases in shell thickness with enhanced predation pressure starting in the 1990s [@Telesca2021-zm]. However, since *N. lapillus* was absent during this time and we specifically sampled shell layer thickness from the dorsal region of the shell and not from the apertural lip to control for predator stress induced thickening of the aperture lip, it is unlikely that an increase in predation pressure caused the observed increase in shell layer thickness in this study. Instead, the historical thickening of *N. lapillus* shell reported here is likely coupled to a general improvement of abiotic and biotic conditions on the Southern North Sea coast which mitigated ocean acidification effects and thereby promoted biomineralization.

### Warmer annual temperatures improved calcification conditions

GAM shell thickness models report a significant correlation between temperature and shell layer thickness. Calcite layer thickness is significantly correlated with air temperature, whereas aragonite layer thickness significantly changes with sea surface temperature (Supplementary Table 5). Fittingly, both sea surface temperature and air temperature significantly increased by `r air_temp_diff` °C and `r sea_temp_diff` °C, respectively throughout the last 130 years along the Belgian coast (Figure 3), in line with global climate change predictions. An increase in mean temperature therefore likely improved calcification conditions for *N. lapillus*, enhancing precipitation rates [@Burton1987-vn; @Joubert2014-vf; @Laing2000-wd], and simultaneously reducing the cost in metabolic energy per unit shell due a proportional reduction of shell organic matter [@Palmer1983-nq; @Palmer1992-uz; @Sanders2018-gr]. In addition, within-year analyses of temperature time series show that winter temperatures (both air and sea surface) increased more rapidly than in the other seasons indicating increasingly milder winters (Supplementary Figure 4). In the laboratory, *N. lapillus* ceases to repair shell damage or to build noticeably new shell below 13 °C (D.M. personal observations). Milder winters could thus allow for a longer period of biomineralization during the year, resulting in increased shell layer thickness due to prolonged “calcification windows”. In fact, calcification window estimates for temperatures from 10 – 15 °C showed a significant increase in days surpassing the temperature thresholds. For a temperature threshold of e.g., 13 °C a relative increase of `r round(calc_win[4,]$percent_change,0)` % was observed which in absolute terms equals `r round(calc_win[4,]$change,0)` days. Thus, in 2019, *N. lapillus* had `r round(calc_win[4,]$change,0)` more days to calcify than in 1880 which likely resulted in thicker shell layers through secondary shell layer thickening. Secondary shell layer thickening (i.e., thickening of the existing shell) only occurs in the crossed lamellar layer in *N. lapillus* which means that prolonged calcification windows (i.e., time as a factor for enhanced calcification) would solely influence aragonite layer thickness. We thus hypothesise that the increase in annual sea surface and air temperature on the Southern North Sea coast has impacted shell calcification of *N. lapillus* in two ways: (1) Acceleration of shell precipitation rate by reducing the energetic cost per unit shell. (2) Extension of annual calcification windows allow for enhanced secondary thickening of the shell aragonite layer.

### Near shore eutrophication mitigated OA effects

Like ambient temperature, the calcium carbonate saturation state of ambient seawater is a crucial variable determining calcification rates. The calcium carbonate saturation state of seawater is defined as the product of the calcium ion ($Ca^{2+}$) and carbonate ion ($CO_3^{2+}$) concentrations in the ocean divided by the solubility product ($K_{sp}$). A reduction in concentration of either calcium or carbonate ions thus reduces the seawater saturation state impairing shell formation [@Gattuso1998-sg; @Schneider2006-nh] and potentially increasing shell dissolution [@Sanders2021-gf]. Lowered seawater salinity is generally associated with lower calcium ion concentrations, whereas decreasing seawater pH is accompanied by a shift in the carbonate system which reduces the concentration of carbonate ions. 

We found that median seawater salinities varied significantly between sampling sites by up to `r OST_sal-ZWA_sal` psu from `r ZWA_sal` psu at Zwarte Polder to `r OST_sal` psu at Oostende which is $\sim85$ % more variable than predicted mean salinity changes on the Belgian coast over the last century [@Telesca2021-zm]. This suggests that salinity effects on shell formation in this study, if present, should be stronger on a spatial than a temporal scale. However, we did not identitfy any significant trends between salinities and shell layer thickness. This suggests that the distribution of *N. lapillus* salinity optimum is rather broad, so that median salinity differences between sampling sites were not sufficiently large to cause stress or reduce physiological performance to the point where it affected shell production in the studied specimens (Supplementary Figure 3). A zero-effect would also be expected considering that salinities at either sampling site remained sufficiently high to maintain saturation states $\Omega$ > 1, favoring calcium carbonate precipitation. 

Contrary to the effect of salinity on calcium ion concentration, decreasing seawater pH as in global OA predictions is accompanied by a change in the seawater carbonate system, shifting the equilibrium away from the carbonate ion towards carbonic acid reducing the calcium carbonate saturation state of the seawater. Laboratory experiments often find a thinning of shells as a response to OA [@Fitzer2015-nr; @Gaylord2011-aj] although the opposite has also been reported [@Cross2015-np; @Cross2019-kd]. Organism responses to OA in nature appear to depend on a number of factors and their interactions, making it difficult to draw general conclusions. To make things more complicated organism responses to OA can take on unexpected forms. For example, a long-term study comparing aragonite percentage in *Mytilus californianus* collected in the 1950s and 2010s reported a significant decrease in aragonite content (as a percentage of whole shell $CaCO_3$) and an increase in calcite content [@Bullard2021-lk]. Although counterintuitive, calcite thickening has been found to be an important response against OA induced shell dissolution [@Cross2019-kd; @Harper2000-xx; @Telesca2021-zm]. 
Unfortunately, we could not directly assess the effect of pH on shell formation due to a lack of a long-term pH record for the Southern North Sea coast. Long-term pH trends of the greater North Sea however appear to follow global OA trends [@Bates2014-rh]. Assimilated data by the International Council of the Exploration of the Seas (ICES) show an average drop of 0.0035 ±0.0014 pH units per year from 1984 – 2014 for much of the North Sea and the English Channel [@Ostle2016-kg]. In contrast, near shore carbonate system model studies [@Borges2010-jq; @Gypens2009-ok] report increasing seawater pH for the years 1951 to 1988, followed by overall stable, albeit increasingly more variable, pH conditions [@Desmit2020-ay]. The authors attributed this to increasing riverine carbon and nutrient loads since the 1960s causing extensive eutrophication of the Belgian near shore. The input of e.g., riverine water with high nutrient loads caused a local alkalinisation. This buffered ocean acidification effects and kept mean annual saturation levels high ($\Omega_{Ar}$ > 2.5 and $\Omega_{Ca}$ > 4) in the second half of the last century [@Borges2010-jq], which provided favourable conditions for *N. lapillus* [@Petraitis2020-gt]. In more recent years a decreasing trend in seawater pH was observed due to a de-eutrophication of the Belgian near shore [@Desmit2020-ay], which will likely impact shell formation in future generations of *N. lapillus*. 

### Food abundance a possible factor?

In addition to buffering OA effects, coastal eutrophication may have had an additional beneficial effect on the carnivorous *N. lapillus* for which there is only anecdotal evidence. Moderate eutrophication can enhance the development of fouling communities [@Page1987-tb; @Thomsen2013-pj; @Wolowicz2006-is], whereas high eutrophication levels can be detrimental to local community structures and increase densities of more tolerant species [@Moran1989-or; @Moran1991-kx; @Rastetter1979-jj]. As explained previously, shell formation comes with costs in metabolic energy suggesting that food abundance can play a limiting role in the rate of shell formation [@Palmer1983-nq; @Palmer1992-uz]. It is well established that the eutrophication on the Belgian near shore led to increased primary production providing increasing nutrient supplies for filter feeders such as barnacles and Mytilus spp., both preferred prey of *N. lapillus* [@Desmit2020-ay; @Gypens2009-ok; @Telesca2021-zm]. In addition, the introduction of the invasive barnacle species *Austrominius modestus* (Darwin, 1954) from New Zealand and southern Australia (Harms, 1998) and its rapid spreading on the Southern North Sea coast provided extensive foraging grounds for *N. lapillus*. Since its first documented sighting on the Dutch coast in 1946 [@Boschma1948-fd], *A. modestus* spread to most parts of the Dutch coast in only six years [@Wolff2005-ed]. On the Belgian coast, *A. modestus* has been reported since 1950 [@Leloup1952-ez], but it may have already been present there earlier. *Austrominius modestus* is now the dominant barnacle species of the Belgian intertidal fauna [@Kerckhof2002-rt], densely covering available hard substrata as well as the shells of other organisms (Supplementary Figure 6). Today, both *A. modestus* and Mytilus spp. are highly abundant on the Belgian and Dutch coasts, providing a wealth of prey for *N. lapillus* (Supplementary Figure 6; D.M. personal observation). Considering the persisting de-eutrophication trend of the Belgian near shore since the 1980s this effect could be expected to be similar, or even larger, in the latter half of the last century suggesting that most specimens analysed here must have obtained enough energy to cover the metabolic costs required for shell production. 

To summarize, observed shell layer thickening in archival *N. lapillus* from the Belgian and Dutch coasts appears to result from the interaction of multiple abiotic and biotic conditions that provided favourable conditions for shell formation throughout the last 130 years. Increasing annual temperatures and extended annual calcification windows provided better kinetic conditions for primary shell production and longer annual periods for secondary shell layer thickening. In addition, anthropogenically induced eutrophication mitigated OA effects maintaining high carbonate saturation states at the Belgian coast. Anecdotal evidence points towards a possible influence of enhanced prey abundance on shell formation rates due to the eutrophication and the rapid spreading of the alien barnacle species *A. modestus* on the Belgian coast since the 1950s.
Our findings suggest that although OA and climate change threaten global ecosystems, their spatial proliferation can be patchy creating niches with environmental conditions favourable for marine calcifiers like *N. lapillus*. This gives hope that within these niches marine calcifiers may survive predicted future OA scenarios longer than expected, extending the point of no return into the future. 

# Data availability

All data and code used in this study are made publicly available on the following git repository: [dm807cam/nucella2021belgium](https://github.com/dm807cam/nucella2021belgium).

# References
